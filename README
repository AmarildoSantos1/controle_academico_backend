
---
# ğŸ“˜ Sistema de Controle AcadÃªmico â€“ Backend Completo (FastAPI + CLI + Criptografia)

## ğŸ“Œ DescriÃ§Ã£o Geral

Este projeto implementa um **Sistema de Controle AcadÃªmico completo**, que permite:

* Gerenciar alunos
* Criar, atualizar e remover disciplinas
* LanÃ§ar notas (E1, E2, E3)
* Gerar mÃ©dias ponderadas (30/30/40)
* Determinar status automÃ¡tico (APROVADO, REPROVADO, EM_CURSO)
* Visualizar disciplinas do aluno via CLI (com status e mÃ©dia)
* Registrar logs de auditoria com criptografia
* Exportar relatÃ³rios CSV (aluno e turma)
* Realizar autenticaÃ§Ã£o com token JWT-like
* Armazenar tudo em JSON
* Executar testes unitÃ¡rios e integrados
* Interface completa via terminal (CLI)

Este README contÃ©m um **guia definitivo** para rodar, testar e entender todo o sistema.

---

# ğŸ› ï¸ Tecnologias Utilizadas

* Python 3.10+
* FastAPI
* Uvicorn
* Pydantic
* Requests
* Cryptography (Fernet/AES)
* Pytest
* JSON (persistÃªncia)

---

# ğŸ“‚ Estrutura do Projeto

```
backend/
â”‚â”€â”€ app.py
â”‚â”€â”€ auth.py
â”‚â”€â”€ storage.py
â”‚â”€â”€ util.py
â”‚â”€â”€ models.py
â”‚â”€â”€ cli.py
â”‚â”€â”€ run_tests.py
â”‚â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ test_domain.py
â”‚   â”œâ”€â”€ test_crypto.py
â”‚   â””â”€â”€ test_api_integration.py
â”‚
â””â”€â”€ data/
    â”œâ”€â”€ alunos.json
    â”œâ”€â”€ logs.json
    â”œâ”€â”€ admin.json
    â”œâ”€â”€ tokens.json
    â””â”€â”€ fernet.key
```

---

# ğŸš€ InstalaÃ§Ã£o e ExecuÃ§Ã£o

## 1ï¸âƒ£ Criar ambiente virtual

### Windows:

```bash
python -m venv .venv
.\.venv\Scripts\activate
```

### Linux/Mac:

```bash
python -m venv .venv
source .venv/bin/activate
```

---

## 2ï¸âƒ£ Instalar dependÃªncias

```bash
pip install -r requirements.txt
```

---

## 3ï¸âƒ£ Iniciar o servidor

```bash
uvicorn app:app --reload --port 8000
```

Acesse:

* API Root â†’ [http://127.0.0.1:8000](http://127.0.0.1:8000)
* DocumentaÃ§Ã£o (Swagger) â†’ [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)

---

# ğŸ” AutenticaÃ§Ã£o

Todas as rotas (exceto `/auth/login`) exigem o header:

```
Authorization: Bearer SEU_TOKEN
```

### ğŸ”‘ Login

```
POST /auth/login
{
  "username": "admin",
  "password": "1234"
}
```

---

# ğŸ–¥ï¸ CLI â€” Interface Completa via Terminal

Para rodar:

```bash
python cli.py
```

Ele exibirÃ¡:

```
1) Login
2) Listar alunos
3) Criar aluno
4) Adicionar disciplina a aluno
5) LanÃ§ar nota em disciplina
6) Listar disciplinas de um aluno
7) Atualizar disciplina
8) Remover disciplina
9) Ver logs de auditoria
0) Sair
```

---

# ğŸ§­ Passo a passo COMPLETO de uso (COM EXEMPLOS REAIS)

Abaixo estÃ¡ um **exemplo real do fluxo**, exatamente como acontece no programa.

---

## â­ 1) Login

```
OpÃ§Ã£o: 1
UsuÃ¡rio [admin]:
Senha [1234]:
âœ… Login realizado com sucesso.
```

---

## â­ 2) Criar aluno 

Este Ã© o exemplo REAL citado antes â€” agora incluso no README:

```
OpÃ§Ã£o: 3

=== NOVO ALUNO ===
Nome: Afonso
Tipo do identificador (MATRICULA/CPF) [MATRICULA]: MATRICULA
Identificador (matrÃ­cula ou CPF): 2025A0005
Data de cadastro (YYYY-MM-DD) [hoje]: 2025-11-30
Ativo? (S/N) [S]: S

âœ… Aluno criado com sucesso!
ID: d627â€¦ | Nome: Afonso
```

â¡ï¸ **Exemplo vÃ¡lido de identificador:**

* `2025A0005` (matrÃ­cula)
* ou `12345678900` (CPF)

---

## â­ 3) Listar alunos

```
OpÃ§Ã£o: 2

=== ALUNOS ===
ID: d627... | Nome: Afonso | Ativo: True
Tipo/ID: MATRICULA 2025A0005
Disciplinas: 0
----------------------------------------
```

---

## â­ 4) Adicionar disciplina

```
OpÃ§Ã£o: 4

ID do aluno: d627...
Nome da disciplina: SeguranÃ§a da InformaÃ§Ã£o
Data: 2025-11-30

âœ… Disciplina criada!
```

---

## â­ 5) LanÃ§ar nota

```
OpÃ§Ã£o: 5

ID do aluno: d627...
ID da disciplina: 8b3f...
EstÃ¡gio (E1/E2/E3): E1
Nota (0 a 10): 8

âœ“ Nota lanÃ§ada
MÃ©dia: None | Status: EM_CURSO
```

ApÃ³s E1, E2 e E3:

```
MÃ©dia: 8.2 | Status: APROVADO
```

---

## â­ 6) Listar disciplinas do aluno 

```
OpÃ§Ã£o: 6

=== DISCIPLINAS DO ALUNO ===
ID do aluno: d627...

Aluno: Afonso (MATRICULA 2025A0005)

=== DISCIPLINAS ===
1) SeguranÃ§a da InformaÃ§Ã£o
    Status: APROVADO
    MÃ©dia: 8.2
    ID: 8b3f...
----------------------------------------

Digite o nÃºmero para ver detalhes:
> 1

=== DETALHES DA DISCIPLINA ===
Nome: SeguranÃ§a da InformaÃ§Ã£o
Cadastro: 2025-11-30
Notas: {'E1': 8, 'E2': 7, 'E3': 9}
MÃ©dia: 8.2
Status: APROVADO
----------------------------------------
```

---

# ğŸ“Š RelatÃ³rios CSV

## Boletim por aluno

```
GET /students/{id}/report.csv
```

## RelatÃ³rio geral da turma

```
GET /reports/class.csv
```

Produz arquivos com notas, mÃ©dias e status.

---

# ğŸ“œ Logs de Auditoria

Logs sÃ£o:

* **cifrados com cifra de CÃ©sar no arquivo**
* **decifrados ao serem exibidos via API e CLI**

Via CLI:

```
OpÃ§Ã£o: 9
[2025-11-30T14:45] ALUNO_CRIADO
  Aluno ID: d627...
  Mensagem: Aluno criado - aluno=d627...
----------------------------------------
```

---

# ğŸ” Criptografia â€” ExplicaÃ§Ã£o Completa (COM EXEMPLOS DO PROJETO)

O sistema utiliza trÃªs mÃ©todos criptogrÃ¡ficos exigidos:

---

## 1ï¸âƒ£ PBKDF2-HMAC-SHA256 â€” Hash seguro de senhas

ğŸ“Œ Arquivo: `auth.py`
ğŸ“Œ Usado em: armazenamento da senha do administrador

### Trecho real do projeto:

```python
dk = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100_000)
```

### Onde Ã© aplicado:

* `ensure_admin()` â†’ cria o hash inicial
* `verify_user()` â†’ validaÃ§Ã£o de login
* `change_password()` â†’ atualizaÃ§Ã£o de senha

ğŸ“Œ **Senhas nunca sÃ£o armazenadas em texto puro.**

---

## 2ï¸âƒ£ Fernet (AES + HMAC) â€” Criptografia simÃ©trica

ğŸ“Œ Arquivos: `util.py`, `storage.py`
ğŸ“Œ Usado para: cifrar o **identificador do aluno**

### Exemplo real gravado no `alunos.json`:

```json
"identificador_enc": "gAAAAABp..."
```

### Onde Ã© aplicado:

```python
encrypt_sensitive(a.identificador)
```

### Onde Ã© decifrado:

```python
ident = decrypt_sensitive(enc)
```

ğŸ“Œ Protege matrÃ­cula/CPF diretamente no arquivo.

---

## 3ï¸âƒ£ Cifra de CÃ©sar â€” Criptografia clÃ¡ssica

ğŸ“Œ Arquivos: `util.py`, `storage.py`
ğŸ“Œ Usado para: cifrar mensagens de logs

### Trecho real:

```python
mensagem_cifrada = caesar_encrypt(mensagem_clara, shift=3)
```

No JSON aparece cifrado:

```
"mensagem_cifrada": "Dorqr fuldugr..."
```

Mas ao consultar via API/CLI:

```
mensagem: "Aluno criado - aluno=d627"
```

ğŸ“Œ Atende ao requisito de criptografia clÃ¡ssica.

---

# ğŸ§ª Testes Automatizados

O sistema possui:

## âœ” Testes UnitÃ¡rios

* MÃ©dia e status
* FunÃ§Ãµes de utilidade
* Hash (PBKDF2)
* Criptografia (Fernet e CÃ©sar)

## âœ” Testes Integrados

* Login
* CriaÃ§Ã£o de aluno e disciplina
* LanÃ§amento de notas
* CSV
* Logs
* Status e mÃ©dia

### Rodar testes:

```bash
python run_tests.py
```

Esse comando:

* Executa o pytest
* Gera um relatÃ³rio amigÃ¡vel
* NÃƒO apaga seus alunos reais
* Remove somente o aluno de teste interno

---

# ğŸ§© Regras de NegÃ³cio

### MÃ©dia:

```
E1 Ã— 0.30 + E2 Ã— 0.30 + E3 Ã— 0.40
```

### Status:

* APROVADO â†’ mÃ©dia â‰¥ 7
* REPROVADO â†’ mÃ©dia < 7
* EM_CURSO â†’ notas incompletas

---

# ğŸ¯ ConclusÃ£o

Este backend estÃ¡ completo e pronto para apresentaÃ§Ã£o, contendo:

* API robusta
* CLI funcional e intuitivo
* TrÃªs mÃ©todos criptogrÃ¡ficos
* Logs protegidos
* RelatÃ³rios CSV
* Testes completos
* PersistÃªncia em JSON
* Fluxo intuitivo e fÃ¡cil de demonstrar
